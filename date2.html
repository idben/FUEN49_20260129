<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .container {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 4px;
            gap: 2px;
        }

        .book {
            display: flex;
            font-size: 20px;
            /* df jcc aic */
            justify-content: flex-start;
            align-items: center;
        }

        .book.title {
            background-color: #4b4545;
            color: #fff;
        }

        .list .book:nth-child(odd) {
            background-color: #f4f3f3;
        }

        .list .book:hover {
            background-color: #d4f0fb;
        }

        .col1 {
            width: 20px;
        }

        .col2 {
            width: 140px;
        }

        .col3 {
            width: calc(100% - 20px - 140px - 140px);
        }

        .col4 {
            width: 140px;
        }
    </style>
    <title>抓取資料產生表格</title>
</head>

<body>
    <div class="container">
        <input type="text" class="sort">
        <button>搜尋</button>
    </div>
    <div class="books">
        <div class="book title">
            <div class="col col1">id</div>
            <div class="col col2">作者</div>
            <div class="col col3">書名</div>
            <div class="col col4">日期</div>
        </div>
        <div class="list"></div>
        <!-- <div class="book">
            <div class="col col1">16</div>
            <div class="col col2">フジカワユカ</div>
            <div class="col col3">無職轉生~到了異世界就拿出真本事~ 2</div>
            <div class="col col4">2017-05-05</div>
        </div> -->
    </div>

    <script src="https://sagedaben.com/iSpan/bookJSON.js"></script>
    <script>
        let asc = true;
        const books = document.querySelector(".books");
        const list = document.querySelector(".list");
        const col4 = document.querySelector(".col4");
        const input = document.querySelector("input");
        const btnSearch = document.querySelector("button");
        let data = JSON.parse(bookData_str);

        btnSearch.onclick = () => {
            const text = input.value;
            init(text);
        }

        col4.onclick = function () {
            // asc = !asc;
            asc = (asc == true) ? false : true;
            init();
        }

        init();


        function init(searchValue = "") {
            list.innerHTML = ""; // 清空

            data.filter(function (d) {
                return d.title.includes(searchValue)
            });

            data.sort(function (a, b) {
                if (!asc) {
                    return new Date(b.date) - new Date(a.date);
                }
                return new Date(a.date) - new Date(b.date);
            });

            for (let i = 0; i < data.length; i++) {
                const template = `<div class="book">
                                <div class="col col1">${i + 1}</div>
                                <div class="col col2">${data[i].author}</div>
                                <div class="col col3">${data[i].title}</div>
                                <div class="col col4">${data[i].date}</div>
                            </div>`;
                const node = document.createElement("div");
                node.innerHTML = template;
                list.append(node.childNodes[0]);
            }
        }
    </script>
</body>

</html>